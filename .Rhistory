set.seed(100)
full$honorific = as.factor(full$honorific)
full$GenderAgeClass = as.factor(full$GenderAgeClass)
train = full[!is.na(full$Survived),]
test = full[is.na(full$Survived),]
titanic.rf = randomForest(factor(Survived) ~ Pclass + Sex + SibSp  + Parch + Fare + Embarked + honorific + GenderAgeClass + FareClass,
data = train)
plot(titanic.rf, ylim=c(0,0.36))
legend('topright', colnames(titanic.rf$err.rate), col=1:3, fill=1:3)
library(e1071)
svmfit = svm(factor(Survived)~., data = train , kernel = "radial", gamma = 1, cost = 100000)
svmfit
prediction <- predict(svmfit, test)
predict(svmfit, test)
prediction <- predict(titanic.rf, test)
prediction
prediction <- predict(svmfit, test)
svmfit
prediction <- predict(svmfit, test)
table(full$Age)
ggplot(full, aes(x = age, y = count())) +
geom_histogram()
ggplot(full, aes(x = Age, y = count())) +
geom_histogram()
ggplot(full, aes(x = Age, y = count())) +
geom_histogram()
ggplot(full[!is.na(full$Age)], aes(x = Age, y = count())) +
geom_histogram()
full[!is.na(full$Age)]
ggplot(full[!is.na(full$Age),], aes(x = Age, y = count())) +
geom_histogram()
full[!is.na(full$Age),]
a = full[!is.na(full$Age),]
ggplot(a, aes(x = Age, y = count())) +
geom_histogram()
ggplot(a, aes(x = as.numeric(Age), y = count())) +
geom_histogram()
ggplot(a, aes(x = as.numeric(Age), stat = count())) +
geom_histogram()
ggplot(a, aes(x = as.numeric(Age))) +
geom_histogram()
ggplot(a, aes(x = as.numeric(Age))) +
geom_histogram( stat = count())
ggplot(a, aes(x = as.numeric(Age))) +
geom_histogram()
ggplot(a, aes(x = Age)) +
geom_histogram()
ggplot(a, aes(x = Age)) +
geom_histogram()
ggplot(a, aes(x = as.numeric(Age))) +
geom_histogram()
ggplot(a, aes(x = Sex, fill = Age)) +
geom_histogram()
ggplot(a, aes(x = Sex, fill = Age)) +
geom_histogram()
ggplot(a, aes(x = Sex, fill = Age)) +
geom_histogram(stat="count")
ggplot(a, aes(x = Sex, fill = Age, stat="count")) +
geom_histogram()
ggplot(a, aes(x = Sex, fill = Age ), stat="count") +
geom_histogram()
ggplot(a, aes(x = Sex, fill = Age )) +
geom_histogram(stat="count")
ggplot(a, aes(x = Sex, fill = Age )) +
geom_bar(stat="count")
ggplot(a, aes(x = Sex, fill = as.factor(Age) )) +
geom_bar(stat="count")
ggplot(a, aes(x = Age, fill = as.factor(Age) )) +
geom_histogram()
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram()
ggplot(a, aes(x = Age )) +
geom_histogram()
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram()
ggplot(a, aes(x = Age )) +
geom_histogram()
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram()
ggplot(a, aes(x = Age )) +
geom_histogram()
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram()
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity")
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .2)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .1)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = 1)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .5)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .4)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .3)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6, color = c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6)
geom_histogram(position = "identity", alpha = .6, colour = c("black", "white"))+
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6, colour = c("black", "white"))+
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6, colour = c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6, colour = c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6, colour = c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex), colour = c("black", "white") )) +
geom_histogram(position = "identity", alpha = .6)
ggplot(a, aes(x = Age, fill = as.factor(Sex), colour = c("black", "white") )) +
geom_histogram(position = "identity", alpha = .6)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", fill = "white",alpha = .6)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6)
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6) +
scale_color_manual(values=c("#999999", "#E69F00"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6) +
scale_color_manual(values=c("#999999", "#E69F00"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6) +
scale_color_manual(values=c("black", "blue"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "blue"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) )) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) , color = "black")) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) , color = "green")) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) , color = "green")) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) , colour = "green")) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) , colours = "green")) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex) , colours = "green")) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("black", "white"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .6) +
scale_fill_manual(values=c("green", "red"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "red"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "black"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "blue"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "yellow"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "grey"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "darkgrey"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "brown"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "cyan"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4)
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4)
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "orange"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "blue"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "purple"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("red", "purple"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("gold", "purple"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple"))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,10))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,1))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))
ggplot(a, aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5))
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5))
ggplot(a, aes(x = Age )) +
geom_histogram() +face facet_grid(Sex~)
ggplot(a, aes(x = Age )) +
geom_histogram() + facet_grid(Sex~)
ggplot(a, aes(x = Age )) +
geom_histogram(
ggplot(a, aes(x = Age )) +
geom_histogram()
ggplot(a, aes(x = Age )) +
geom_histogram()
ggplot(a, aes(x = Age )) +
geom_histogram()
ggplot(a, aes(x = Age )) +
geom_histogram()
ggplot(a, aes(x = Age )) +
geom_histogram() + facet_grid(Sex~)
ggplot(a, aes(x = Age )) +
geom_histogram() + facet_grid(~Sex)
ggplot(a, aes(x = Age )) +
geom_histogram() +
facet_grid(~Sex) +
scale_y_continuous(breaks = seq(0,80,5))
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5))
ggplot(full[!is.na(full$Age),], aes(x = Age )) +
geom_histogram() +
facet_grid(~Sex) +
scale_y_continuous(breaks = seq(0,80,5))
ggplot(full[!is.na(full$Age),], aes(x = Age )) +
geom_histogram() +
facet_grid(~Sex) +
scale_y_continuous(breaks = seq(0,80,5)) +
scale_x_continuous(breaks = seq(0,90,5))
ggplot(full[!is.na(full$Age),], aes(x = Age )) +
geom_histogram() +
facet_grid(~Sex) +
scale_y_continuous(breaks = seq(0,80,5)) +
scale_x_continuous(breaks = seq(0,90,10))
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5))
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,10))
ggplot(full[!is.na(full$Age),], aes(x = Age )) +
geom_histogram() +
facet_grid(~Sex) +
scale_y_continuous(breaks = seq(0,80,5)) +
scale_x_continuous(breaks = seq(0,90,10))
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5))
ggplot(full[!is.na(full$Age),], aes(x = Age )) +
geom_histogram() +
facet_grid(~Sex) +
scale_y_continuous(breaks = seq(0,80,5)) +
scale_x_continuous(breaks = seq(0,90,10)) +
ggtitle("Age Dsitribution of Passenger")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5))
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
legend("")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
guide_legend(title = waiver())
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
guide_legend(title = "")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +  scale_fill_discrete("")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
theme ()
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
theme(legend.position="top", legend.direction="horizontal")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "dodge",, alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity",, alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
labs(fill="")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity",, alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
labs(fill="")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity",, alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
labs(fill="")
ggplot(full[!is.na(full$Age),], aes(x = Age, fill = as.factor(Sex))) +
geom_histogram(position = "identity", alpha = .4) +
scale_fill_manual(values=c("green", "purple")) +
scale_y_continuous(breaks = seq(0,80,5))+
scale_x_continuous(breaks = seq(0,90,5)) +
ggtitle("Age Dsitribution of Passenger") +
labs(fill="")
ggplot(full[!is.na(full$Age),], aes(x = Sex, fill = as.factor(Sex))) +
geom_boxplot()
ggplot(full[!is.na(full$Age),], aes(x = Sex, fill = as.factor(Age))) +
geom_boxplot()
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot()
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5))+
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5))
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5))
means <- aggregate(Age ~  Sex, full, mean)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( full[!is.na(full$Age),], aes(x = Sex, y = means, label = means),
size = 3, vjust = -1.5)
means
means <- aggregate(Age ~  Sex, full, mean)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( full[!is.na(full$Age),], aes(x = Sex, y = means, label = means),
size = 3, vjust = -1.5)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( means, aes(x = Sex, y = means, label = means),
size = 3, vjust = -1.5)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( means, aes( y = means, label = means), size = 3, vjust = -1.5)
means <- aggregate(Age ~  Sex, full, median)
medians = aggregate(Age ~  Sex, full, median)
medians = aggregate(Age ~  Sex, full, median)
medians
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( means, aes( y = means, label = means), size = 3, vjust = -1.5)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( means, aes( y = means, label = means), size = 3, vjust = -1.5)
medians
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = medians, y = medians))
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = medians, y = Age))
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age))
medians
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = medians))
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age))
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age), vjust = 1)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age), vjust = -2)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age), vjust = -1.5)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age), vjust = -1)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age), vjust = -.8)
ggplot(full[!is.na(full$Age),], aes(x = Sex, y = Age)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,80,5)) +
geom_text( data = medians, aes( label = Age, y = Age), vjust = -.5)
full$age[full$sex == "female"]
full$age
full$age[full$Sex == "female"]
full$Sex
full$Sex == "female"
full$age[full$Sex == "female"]
full$age
full$age
full$age
full$Age[full$Sex == "female",]
full$Age[full$Sex == "female"]
full$Age[full$Sex == "female" & is.na(full$Age)]
full$Age[full$Sex == "female" & is.na(full$Age)] = 27
full$Age[full$Sex == "female" & is.na(full$Age)]
full$Age[full$Sex == "male" & is.na(full$Age)]
full$Age[full$Sex == "male" & is.na(full$Age)] = 28
full$Age[full$Sex == "male" & is.na(full$Age)]
titanic.rf = randomForest(factor(Survived) ~ Pclass + Sex + SibSp  + Parch + Fare + Embarked + honorific + GenderAgeClass + FareClass + Age,
data = train)
titanic.rf = randomForest(factor(Survived) ~ Pclass + Sex + SibSp  + Parch + Fare + Embarked + honorific + GenderAgeClass + FareClass ,
data = train)
train = full[!is.na(full$Survived),]
test = full[is.na(full$Survived),]
titanic.rf = randomForest(factor(Survived) ~ Pclass + Sex + SibSp  + Parch + Fare + Embarked + honorific + GenderAgeClass + FareClass + Age ,
data = train)
plot(titanic.rf, ylim=c(0,0.36))
set.seed(100)
titanic.rf = randomForest(factor(Survived) ~ Pclass + Sex + SibSp  + Parch + Fare + Embarked + honorific + GenderAgeClass + FareClass + Age ,
data = train)
plot(titanic.rf, ylim=c(0,0.36))
titanic.rf
legend('topright', colnames(titanic.rf$err.rate), col=1:3, fill=1:3)
prediction <- predict(titanic.rf, test)
table(prediction,genderclassmodel[,2])
mean(prediction != genderclassmodel$Survived)
prediction <- predict(titanic.rf, test)
submission = data.frame(PassengerId = test$PassengerId, Survived = prediction)
write.csv(submission, "submission.csv", row.names = FALSE)
